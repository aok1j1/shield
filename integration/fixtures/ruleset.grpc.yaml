rules:
  - frontend:
      url: "/helloworld.Greeter/StreamExample"
      methods: [ "POST" ]
    backend:
      url: "http://127.0.0.1:13877/"
    middlewares:
      - name: basic_auth
        config:
          users:
            - user: user
              password: $apr1$RfxoV6GP$.GsGgD580H5FOuUfTzKZh0

  - frontend:
      url: "/helloworld.Greeter/SayHello"
      methods: [ "POST" ]
    backend:
      url: "http://127.0.0.1:13877/"
    middlewares:
      - name: basic_auth
        config:
          users:
            - user: user
              password: $apr1$RfxoV6GP$.GsGgD580H5FOuUfTzKZh0
              capabilities: [ "hello:shield" ]
          scope:
            action: "hello:{{.name}}"
            attributes:
              name:
                type: grpc_payload
                index: 1
    hooks:
      - name: authz
        config:
          action: some_action
          attributes:
            project_resp:
              index: 1
              type: grpc_payload